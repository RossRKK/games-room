!function(){"use strict";var e="VideoSync",n="wss://games-room.herokuapp.com";function t(e){let n=e.querySelectorAll("video");if(0===n.length)return null;if(1===n.length)return n[0];{let e=[e=>e.currentTime>0,e=>""!==e.src],t=Array.from(n);for(let n=0;t.length>0&&n<e.length;n++)t=t.filter(e[n]);return t.length?t[0]:null}}let o=t(document);if(!o){let e=document.querySelector("iframe");if(!e)return void alert("No video element found");{let n=(r=e).contentWindow?r.contentWindow.document:r.contentDocument;if(!(o=t(n)))return void alert("No video element found")}}var r;const s="PAUSED",l="PLAYING";let i=s;function a(t,r){var a=n+"/"+encodeURIComponent(e)+"/"+encodeURIComponent(t)+(r?"/"+encodeURIComponent(r):"");console.log(a);var d=new WebSocket(a);d.pingInterval=setInterval(function(){console.log("ping"),d.send(JSON.stringify({type:"ping"}))},3e4),d.onmessage=function(e){switch((e=JSON.parse(e.data)).type){case"update":o.currentTime=e.time,(i=e.state)===l&&o.paused?(console.log("auto play"),o.play()):i!==s||o.paused?console.log("local state matched network message"):(console.log("auto pause"),o.pause());break;case"ID":alert("Joined Room "+e.id),console.log(e.id)}};var c=(e,n)=>{(o.paused?s:l)!==i&&e(n)},u=e=>{console.log("sending play msg"),d.send(JSON.stringify({type:"play",currentTime:o.currentTime}))};o.addEventListener("play",e=>{c(u,e)}),o.addEventListener("playing",e=>{c(u,e)});var m=e=>{console.log("sending pause msg"),d.send(JSON.stringify({type:"pause",currentTime:o.currentTime}))};o.addEventListener("pause",e=>{c(m,e)}),o.addEventListener("waiting",e=>{c(m,e)}),o.addEventListener("stalled",e=>{c(m,e)});var g=e=>{console.log("sending seek msg"),d.send(JSON.stringify({type:"seek",currentTime:o.currentTime}))};o.addEventListener("seeked",e=>{c(g,e)})}var d=prompt("Username"),c=prompt("Room Code");console.log(c),a(d,c)}();
